#!/bin/bash 

# ivector 1 period
ivector-extract-online2 --config=ivector_extractor_1peri.conf ark:data/spk2utt scp:data/feats.scp ark,t:ivector_1peri.ark

: << '1PERIOD'
sp0.9-fe_03_00047-A-025005-025135  [
  -0.05481104 -0.2503826 -0.1976649 0.06236598 -0.05787846 0.03600616 -0.2081256 0.007707624 -0.04766336 0.05520358 0.02665314 0.08911538 0.0378064 -0.03840204 -0.01772447 -0.008979923 -0.01466551 -0.03111429 -0.02045617 0.06021559 -0.05634518 -0.09204752 -0.04826043 0.06047024 -0.04615552 0.005267949 -0.002541824 -0.0403229 -0.07641514 0.03099655 -0.01421803 -0.002516943 0.01855663 0.009304918 -0.02215013 0.02221064 -0.01406273 -0.01421851 -0.01294522 -0.01721431 -0.005818468 0.007562195 0.02554239 -0.00380572 -0.014346 0.008980742 -0.01621333 0.01883743 -0.007151075 0.01933841 0.007644066 0.0160083 0.02149824 -0.02038429 0.006807684 -0.00835392 -0.01163141 0.009665888 -0.001042429 0.0188862 0.0222719 0.01557748 -0.001424779 0.005792598 0.003723993 -0.001619783 -0.005959249 -0.009549674 -0.01111177 0.0008254989 -0.01940209 -0.0006018031 -0.004013713 9.904037e-05 0.001943288 -0.009734297 0.002499363 -0.00849778 -0.007002468 -0.002233411 -0.000794967 -0.004195054 -0.001925729 0.001547029 0.0009419171 -0.006096468 0.001084648 -0.006111296 -0.003417504 0.0002199103 -0.004600667 0.006985982 -0.001534339 0.0004152815 -0.00327635 -4.548917e-05 0.001311616 -0.0005466378 -0.0007998691 0.0002760499 
                                        .
                                        .
                                        .
(row 12)
0.1498208 0.09646133 -1.139705 -0.3899139 -1.362835 0.6300951 -1.696942 -1.402019
1PERIOD

# ivector no period
ivector-extract-online2 --config=ivector_extractor_noperi.conf ark:data/spk2utt scp:data/feats.scp ark,t:ivector_noperi.ark

: << 'NOPERIOD'
sp0.9-fe_03_00047-A-025005-025135  [
  -0.05481104 -0.2503826 -0.1976649 0.06236598 -0.05787846 0.03600616 -0.2081256 0.007707624 -0.04766336 0.05520358 0.02665314 0.08911538 0.0378064 -0.03840204 -0.01772447 -0.008979923 -0.01466551 -0.03111429 -0.02045617 0.06021559 -0.05634518 -0.09204752 -0.04826043 0.06047024 -0.04615552 0.005267949 -0.002541824 -0.0403229 -0.07641514 0.03099655 -0.01421803 -0.002516943 0.01855663 0.009304918 -0.02215013 0.02221064 -0.01406273 -0.01421851 -0.01294522 -0.01721431 -0.005818468 0.007562195 0.02554239 -0.00380572 -0.014346 0.008980742 -0.01621333 0.01883743 -0.007151075 0.01933841 0.007644066 0.0160083 0.02149824 -0.02038429 0.006807684 -0.00835392 -0.01163141 0.009665888 -0.001042429 0.0188862 0.0222719 0.01557748 -0.001424779 0.005792598 0.003723993 -0.001619783 -0.005959249 -0.009549674 -0.01111177 0.0008254989 -0.01940209 -0.0006018031 -0.004013713 9.904037e-05 0.001943288 -0.009734297 0.002499363 -0.00849778 -0.007002468 -0.002233411 -0.000794967 -0.004195054 -0.001925729 0.001547029 0.0009419171 -0.006096468 0.001084648 -0.006111296 -0.003417504 0.0002199103 -0.004600667 0.006985982 -0.001534339 0.0004152815 -0.00327635 -4.548917e-05 0.001311616 -0.0005466378 -0.0007998691 0.0002760499 
  0.1498208 0.09646133 -1.139705 -0.3899139 -1.362835 0.6300951 -1.696942 -1.402019
NOPERIOD


# ivector max2
ivector-extract-online2 --config=ivector_extractor_noperi.conf ark:data/spk2utt_max2 scp:data/feats.scp ark,t:ivector_noperi_max2.ark
diff ivector_noperi.ark ivector_noperi_max2.ark -c > ivector_max2.diff

: << 'MAX2DIFF'
*** ivector_noperi.ark	2017-09-26 14:30:37.461239464 +0900
--- ivector_noperi_max2.ark	2017-09-26 14:30:37.617239706 +0900
***************
*** 30,79 ****
    0.1380677 -0.2502632 -1.48587 -1.274342 -4.006834 2.078878 -3.433404 -3.490204 -0.2781204 1.863335 4.430264 -3.689425 -4.334307 -0.0398706 -1.056765 -1.138841 0.6662444 1.307263 1.144754 0.9647307 -1.260424 -0.7006578 1.298229 0.322638 1.407697 0.003685492 -0.7128133 -0.2850085 0.1278639 0.3120023 1.340001 -1.999097 0.9190012 0.3751893 0.03785852 0.2944281 0.03597039 0.4822142 -0.4792722 -0.2596316 0.7503628 -0.2531585 0.6899483 -0.3936056 -0.1322309 0.35496 0.6011392 -1.457238 0.3818676 -0.287673 0.2545808 0.6271461 -0.5318208 -0.9223691 0.3400689 -0.1697295 -0.3475857 -0.2849041 0.009996788 -0.01996002 0.2438041 -0.09889375 -0.2045902 -0.05233289 -0.4354629 0.3920512 -0.2150923 -0.4316693 -0.1863111 -0.3716727 -0.249411 0.136183 0.07956367 -0.03163269 -0.05449734 -0.3381945 0.607639 0.04600001 -0.2210989 -0.4088019 0.2956029 -0.1184529 -0.1290931 0.1967991 0.0625014 -0.2065695 -0.0561406 -0.1299808 0.08132546 0.002364311 0.07886324 -0.03096685 0.02672168 -0.04389321 -0.1385918 0.07367229 0.06482378 -0.01271978 0.01701823 0.1226908 
    0.1446023 -0.266194 -1.468056 -1.256046 -4.004147 2.112672 -3.482115 -3.46746 -0.4107343 1.828004 4.370054 -3.678497 -4.383406 0.06011534 -1.092881 -1.140619 0.7211999 1.180361 1.215547 0.8871727 -1.414026 -0.7589679 1.402645 0.4301459 1.339143 -0.04085758 -0.8514387 -0.3612328 0.1731722 0.2563553 1.308662 -2.086183 0.7642626 0.3924245 0.02981659 0.4073331 0.01243873 0.4655703 -0.5344359 -0.2449357 0.7205424 -0.2208504 0.4870636 -0.4029511 -0.08263066 0.4104747 0.5383534 -1.373242 0.3664049 -0.2938575 0.2944807 0.6502442 -0.5948266 -0.9193876 0.3740362 -0.2203601 -0.3172907 -0.2741527 0.0008672657 -0.006056023 0.312259 -0.1435751 -0.194676 -0.04305787 -0.4028231 0.4375654 -0.2050967 -0.4370729 -0.0924255 -0.3903593 -0.2362534 0.1156393 0.1232173 -0.04657457 -0.03996598 -0.2875547 0.6523618 0.03834601 -0.2222278 -0.4069774 0.2665682 -0.1431775 -0.1222465 0.2025944 0.06242264 -0.259484 -0.02807549 -0.09394524 0.06476808 -0.006399153 0.08332197 -0.02241269 0.02403915 -0.04157637 -0.1470142 0.06885856 0.06829425 -0.01097774 0.01963185 0.1228188 ]
  sp0.9-fe_03_00047-A-027882-028083  [
!   0.1651063 -0.2669176 -1.476365 -1.242687 -4.001018 2.1121 -3.47996 -3.457055
                                       .
                                       .
                                       .
MAX2DIFF
# the ivector of the third and fourth utterances are different.

rm -f ivector_1peri.ark ivector_noperi.ark ivector_noperi_max2.ark ivector_max2.diff
