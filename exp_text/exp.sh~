#!/bin/bash

# veiw trascription, lmcost, amcost
lattice-1best --acoustic-scale=0.1 "ark:gunzip -c sample/lat.1.gz |" ark:- | \
  nbest-to-linear ark:- ark,t:lat.1.ali "ark,t:|int2sym.pl -f 2- sample/words.txt > lat.1.text" ark,t:lat.1.lmcost ark,t:lat.1.amcost

: << 'ALIFILE'
fe_03_00001-A-000376-000554 2572 3016 3430 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 3429 36054 36053 36053 36280 36279 36279 36524 36523 36523 36523 12270 12269 12269 12269 12324 12323 12323 12514 12513 12513 12513 12513 12513 12513 2 1 1 1 1 8 5 5 5 5 5 18 28786 28785 28785 28785 28785 28785 28785 28785 28785 28785 28785 28828 28827 28827 28827 28827 28862 28861 28861 28861 28861 16248 16352 16351 16536 36132 36131 36426 36640 18002 18001 18001 18001 18188 18187 18187 18400 18399 5210 5672 5671 6016 6015 31742 31741 31986 31985 31985 32136 32135 27016 27306 27588 27587 27587 39588 39587 39587 39587 39622 39621 39676 41458 41457 41457 41652 41884 5320 5319 5514 5854 5853 20512 20511 20586 20585 20585 20585 20585 20585 20598 20597 20597 17580 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17579 17660 17659 17659 17659 17659 17922 17921 17921 17921 17921 2 8 18 
ALIFILE

: << 'TEXTFILE'
fe_03_00001-A-000376-000554 and generally prefer 
fe_03_00001-A-000582-000648 eating at home 
TEXTFILE

: << 'LMCOST'
fe_03_00001-A-000376-000554 36.90882 
fe_03_00001-A-000582-000648 20.01983 
LMCOST

: << 'AMCOST'
fe_03_00001-A-000376-000554 -1089.398 
fe_03_00001-A-000582-000648 -509.8568 
AMCOST

# check perplexity
$SRILM/ngram -lm sample/lm_unpruned.gz -vocab sample/words.txt -ppl lat.1.text | tee lat.1.ppl 

: << 'PPL'
file lat.1.text: 137 sentences, 834 words, 0 OOVs
0 zeroprobs, logprob= -1859.357 ppl= 82.20329 ppl1= 169.6076
PPL


rm -f lat.1.ali lat.1.text lat.1.lmcost lat.1.amcost lat.1.ppl

